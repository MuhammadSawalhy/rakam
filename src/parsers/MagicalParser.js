/*!
 * 
 * magical-parser v1.0.0       Wed Jul 15 2020 18:31:29 GMT+0200 (Eastern European Standard Time)
 * by Mohammed Samir       ms.2052001@gmail.com
 * https://github.com/scicave/magical-parser#readme
 * 
 * License: GPL-3.0
 * 
 * Build: 31a89eae6ec96bc72cc5
 * 
 */
var MagicalParser=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){var r=n(1).default;e.exports=r},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function u(e){var t=f();return function(){var n,r=p(e);if(t){var o=p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return i(this,n)}}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return c(e,arguments,p(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),l(r,e)})(e)}function c(e,t,n){return(c=f()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&l(o,n.prototype),o}).apply(null,arguments)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.r(t);var h=function(e){a(n,e);var t=u(n);function n(e,r){var a;return o(this,n),(a=t.call(this,e)).position=r,a.messsege=e,a}return n}(s(Error)),d=function(e){a(n,e);var t=u(n);function n(e,r){var a;return o(this,n),(a=t.call(this,e)).position=r,a.messsege=e,a}return n}(s(Error)),g=function(e){a(n,e);var t=u(n);function n(e,r){var a;return o(this,n),(a=t.call(this,e)).position=r,a.messsege=e,a}return n}(s(Error));function y(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){i=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(i)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e){return e.replace(/[+*/.$^(){|}[\]]/g,(function(e){return"\\"+e}))}var b={symbols:"!\"'#$%&()*+,-./:;<=>?@[\\]^_`{|}~€‚„…†‡ˆ‰‹‘’“”•–—˜™›¡¢£¤¥¦§¨©«¬®¯°±²³´¶·¸¹º»¼½¾¿×÷",isSymbol:function(e){return/(?:[$+<->^`|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B98-\u2BFF\u2CE5-\u2CEA\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uFB29\uFBB2-\uFBC1\uFDFC\uFDFD\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6C\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED5\uDEE0-\uDEEC\uDEF0-\uDEFA\uDF00-\uDF73\uDF80-\uDFD8\uDFE0-\uDFEB]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD0D-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDE53\uDE60-\uDE6D\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])/.test(e)},isEmoji:function(e){return/(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5\uDEEB\uDEEC\uDEF4-\uDEFA\uDFE0-\uDFEB]|\uD83E[\uDD0D-\uDD3A\uDD3C-\uDD45\uDD47-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDDFF\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])/.test(e)},isWhiteSpace:function(e){return/[\t-\r \x85\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/.test(e)},isNum:function(e){return!isNaN(e)},isAlpha:function(e){return!isNaN(e)&&!b.isSymbol(e)},spaced:function(e){return!b.isSymbol(e)},isVarName:function(e){var t=this;e.replace(/^\s*(.*)\d*\s*$/,(function(e,n){var r,o=y(n);try{for(o.s();!(r=o.n()).done;){var a=r.value;t.isAlpha(a)||"_"===a}}catch(e){o.e(e)}finally{o.f()}}))},check:function(e,t){switch(t){case"name":return this.isVarName(e);case"num":return!isNaN(e);case"all":return!0;default:return t instanceof RegExp?t.test(e):(console.log('checking test "'.concat(t,'" is not supported.')),!0)}}};function D(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;switch(t=t+(n=""===(n=n||"")?"":"\n"+n+"\n")+(r=isNaN(r)?r?"position: ".concat(r):"":new Array(r).fill("_").join("")+"^"),e){case"forbiddenChars":throw new h(t);case"operators":throw new d(t);case"blocks":throw new g(t);default:throw new Error(t)}}function w(e,t){return e.indexOf(t)>-1}function x(){return x.operationBlockChar+(Date.now()+x.randomNameNum++).toString(36)+x.operationBlockChar}x.randomNameNum=0,x.operationBlockChar="¶";var E=["¶"];function F(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){i=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(i)throw a}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _=function(){function e(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(O(this,e),o.name=o.name||t,Object.assign(this,Object.assign(o,this)),this.childrenNum=n,r.length!==n&&n>-1)throw Error("rules num in "+(this.name+" "||!1)+"must be "+this.rulesNum);var a,u=F(r);try{for(u.s();!(a=u.n()).done;){var i=a.value;i.parentRule=this}}catch(e){u.e(e)}finally{u.f()}this.childrenRules=r}var t,n,r;return t=e,(n=[{key:"getRegex",value:function(e){return""}},{key:"parse",value:function(e,t){throw new Error("You mustn't call this function directly from the abstract class Rule.")}},{key:"getBlocksInside",value:function(){if(this instanceof N)return[rule];var e,t=[],n=F(this.children);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.concat(r.getBlocksInside())}}catch(e){n.e(e)}finally{n.f()}return t}}])&&S(t.prototype,n),r&&S(t,r),e}();function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var T=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};A(this,e),Object.assign(this,r),this.args=n instanceof Array?n:[n],this.type=t}var t,n,r;return t=e,(n=[{key:"check",value:function(e){for(var t in arguments.length>1&&void 0!==arguments[1]||this.args.length,e)if(this[t]!==e[t])return!1;return!0}},{key:"contains",value:function(e){if(this.check(e))return!0;if(this.args)for(var t=0;t<this.args.length;t++)if(this.args[t].contains(e))return!0;return!1}},{key:"isLiteral",get:function(){return"literal"===this.type}}])&&C(t.prototype,n),r&&C(t,r),e}();function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P(e);if(t){var o=P(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return z(this,n)}}function z(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(a,e);var t,n,r,o=B(a);function a(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e.opening=e.opening instanceof RegExp?e.opening.source:v(e.opening),e.closing=e.closing instanceof RegExp?e.closing.source:v(e.closing),!e.opening||!e.closing)throw new Error("Error on defining your block, you should define the opening and closing properties as the regex or the text");return e.opening!==e.closing&&(e.blockState=!0),e.content=e.content||"all",e.groupsNumInside=0,e.content instanceof _||(e.content instanceof RegExp?e.content=e.content.source:e.content="all"===e.content?"(?:.|\\s)*?":v(e.content),e.groupsNumInside+=function e(t){var n=0,r=t instanceof RegExp?t.source:t;if(""==r)return 0;if(""==(r=r.replace(/\\./g,"").replace(/^([^(])+/,"")))return 0;if(r.indexOf("(")>-1)for(var o=1,a=1;a<r.length;a++)if(")"==r[a]?o--:"("==r[a]&&o++,0==o){var u=r.slice(1,a);"?:"!==r.slice(1,3)&&n++,n+=e(u),n+=e(r=r.slice(a+1));break}return n||0}(e.content)),(t=o.call(this,"Block",0,[],e)).openingReg=new RegExp(t.opening),t.closingReg=new RegExp(t.closing),t}return t=a,(n=[{key:"getRegex",value:function(e,t){if(this.blockState&&!t)return this._blockStateToParents(),this.id=x(),e=e||{num:0,increase:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.num+=e,this}},this.realRegex=new RegExp(this.getRegex(null,!0)),this.index=e.num,this.content instanceof _&&(this.parser=new q(this.childrenRules[0])),this.rootParser.blocksRules.push(this),this.rootParser.blockState=!0,this.matchIdRegex=new RegExp("".concat(this.id).concat("¶","\\d+").concat("¶")),"(".concat(this.matchIdRegex.source,")");var n;e=e||{num:0,increase:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.num+=e,this}},this.index=e.num,this.content instanceof _?n=this.content.getRegex(e.increase()):(e.increase(this.groupsNumInside+1),n="("+this.content+")");var r="".concat(this.opening).concat(n).concat(this.closing);return this.regex=r,"(".concat(r,")")}},{key:"_blockStateToParents",value:function(){for(var e=this.parentRule;e;)e.blockState=!0,e=e.parentRule}},{key:"getMatchId",value:function(e){return this.id+"¶"+e+"¶"}},{key:"parse",value:function(e,t){if(this.blockState){var n=t||e[this.index+1],r=[],o=n.split("¶")[3];return n=this.rootParser.matches[this.id][o],this.parser&&(r=this.parser.parse(n.content)),new T(this.name,r,{match:n.str,content:n.content})}var a=t||e[this.index+1],u=[];return this.content instanceof _?u=this.content.parse(e):this.parser&&(u=this.parser.parse(a)),new T(this.name,u,{match:a,content:e[this.index+2]})}}])&&I(t.prototype,n),r&&I(t,r),a}(_);function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rule=t}var t,n,r;return t=e,(n=[{key:"prepareBlocks",value:function(){this.blocks=this.rule.getBlocksInside()}},{key:"prepareRegexes",value:function(){this.regex=rule.getRegex()}},{key:"rule",get:function(){return this._rule},set:function(e){this._rule=e,this.prepareBlocks(),this.prepareRegexes()}}])&&M(t.prototype,n),r&&M(t,r),e}();function U(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){i=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(i)throw a}}}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.grammer=t instanceof $?t:t instanceof _?new $(t):t,this.blockState=!t.blocks||0===t.blocks.length,this.matchesTest=new RegExp("(".concat("¶","\\w+").concat("¶",")").concat("¶","(\\d+)").concat("¶"),"g"),this.matches=[];!function e(t){t.rootParser=n;var r,o=U(t.childrenRules);try{for(o.s();!(r=o.n()).done;){e(r.value)}}catch(e){o.e(e)}finally{o.f()}}(this.grammer),this.prepareRegex()}var t,n,r;return t=e,(n=[{key:"prepareRegex",value:function(){this.regex=new RegExp("^\\s*"+this.grammer.getRegex()+"\\s*$")}},{key:"parse",value:function(e){var t=this;if(this.regex&&e){var n;if(this.blockState){var r,o=U(this.blocksRules);try{var a=function(){var n=r.value,o=[];!function t(r,o){var a,u,i,s,c,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=r.search(n.openingReg),p=r.search(n.closingReg);if(l>-1&&p>-1&&p>l){c=0,r.replace(n.openingReg,(function(e){c=e.length})),u=l,a=l+c,r=r.slice(a);for(var h=1;h>0;){if(l=r.search(n.openingReg),!((p=r.search(n.closingReg))>-1))throw new Error("block seams not to be closed, correct it and try again.");l>p||-1===l?h--:h++}c=0,r.slice(p).replace(n.closingReg,(function(e){c=e.length})),s=(i=a+p)+c,o.push({str:e.slice(u+f,s+f),content:e.slice(a+f,i+f),start:u+f,end:s+f,contentStart:a+f,contentEnd:i+f,realIndexes:{start:u+f,end:s+f,contentStart:a+f,contentEnd:i+f}}),""!==(r=r.slice(p+c))&&t(r,o,f+s)}}(e,o),t.matches[n.id]=o;for(var a=0;a<o.length;a++)if(n.realRegex.test(o[a].str)){var u=n.getMatchId(a);e=e.slice(0,o[a].start)+u+e.slice(o[a].end);for(var i=a+1;i<o.length;i++){var s=u.length-o[a].str.length;o[i].start+=s,o[i].end+=s,o[i].contentStart+=s,o[i].contentEnd+=s}}};for(o.s();!(r=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}}if(e.replace(this.regex,(function(){n=arguments})),!n)throw new Error("your code doesn't match");return n.pop(),n.pop(),this.grammer.parse(n)}throw new Error("Ops, there was a problem in parsing process, perhaps your string is not valid for starting parsing, or your grammer is not precise")}}])&&K(t.prototype,n),r&&K(t,r),e}();function Z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Q(e);if(t){var o=Q(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Y(this,n)}}function Y(e,t){return!t||"object"!==W(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=function(){function e(t){H(this,e),t=t||{},t=Object.assign({zIndex:0},t),Object.assign(this,t)}var t,n,r;return t=e,(n=[{key:"toString",value:function(){return this.regexStr}},{key:"name",get:function(){return this._name||this._id},set:function(e){this._name=e}},{key:"id",get:function(){return this._id},set:function(e){if(!e||""===e)throw new Error("operator id can not be void or empty");this._id=e,e instanceof RegExp?this.regexStr=e.toString().slice(1,-1):this.regexStr=v(e.toString()),this.regex=new RegExp(this.regexStr),this.spaced={right:b.spaced(e[e.toString().length-1]),left:b.spaced(e[0])}}},{key:"spaced",get:function(){return this._spaced},set:function(e){this._spaced="object"===W(e)?Object.assign({},e):{right:e,left:e}}}])&&J(t.prototype,n),r&&J(t,r),e}(),ee=function(e){Z(n,e);var t=V(n);function n(e){return H(this,n),t.call(this,e)}return n}(X),te=function(e){Z(n,e);var t=V(n);function n(e){return H(this,n),t.call(this,e)}return n}(X),ne=function(e){Z(n,e);var t=V(n);function n(e){return H(this,n),t.call(this,e)}return n}(X),re=function(e){Z(n,e);var t=V(n);function n(e){return H(this,n),t.call(this,e)}return n}(X);function oe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=ue(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){i=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(i)throw a}}}}function ae(e){return function(e){if(Array.isArray(e))return ie(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ue(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){if(e){if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ie(e,t):void 0}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};se(this,e),this.options=t,this.prepareOptions(t)}var t,n,r;return t=e,(n=[{key:"prepareOptions",value:function(e){(e=Object.assign({nameTest:"[_a-zA-Z]+\\d*",numTest:"\\d*\\.?\\d+|\\d+\\.?\\d*",blocks:[],args:[],operators:[],suffixOperators:[],prefixOperators:[],separators:[],forbiddenChars:[]},e)).forbiddenChars=[].concat(ae(e.forbiddenChars),ae(specialChars));var t={operators:"",prefixOperators:"",suffixOperators:""},n=function(e){if(e&&e.length>0){for(var t=" ",n=function(n){var r=e[n],o=!1;t.replace(new RegExp("\\(@(".concat(r.regexStr,")#(\\d*)\\)")),(function(t,a,u){return Object.assign(e[n],e[parseInt(u)]),e.splice(parseInt(u),1),o=!0," (@".concat(r.toString(),",#").concat(n,") ")})),o||(t+="(@".concat(r.regexStr,"#").concat(n,")"))},r=0;r<e.length;r++)n(r);return t}};return t.operators=n(e.operators),t.prefixOperators=n(e.prefixOperators),t.suffixOperators=n(e.suffixOperators),e.all=t,(t={operators:"",prefixOperators:"",suffixOperators:""}).operators=(n=function(e){if(0==e.length)return"";if(e&&e.length>0){for(var t="",n=0;n<e.length;n++){var r=e[n];t+="".concat(r.regexStr,"|")}return t.slice(0,-1)}})(e.operators),t.prefixOperators=n(e.prefixOperators),t.suffixOperators=n(e.suffixOperators),e.allRegex=t,e.operators&&(e.operators=e.operators.sort((function(e,t){return-(e.zIndex-t.zIndex)}))),e.blocks={values:e.blocks,openedBlock:null},e.rulesRegex=[],e.rules.forEach((function(t){e.rulesRegex.push(new RegExp(t.getRegex()))})),e.nameTestReg=new RegExp(e.nameTest),e.numTestReg=new RegExp(e.numTest),e.operationTestGrouped="(?:(".concat(e.nameTest,")\\s*)?(")+operationBlockChar+e.nameTest+operationBlockChar+")",e.operationTestGroupedReg=new RegExp("^\\s*".concat(e.operationTestGrouped,"\\s*$")),e.operationTest="(?:".concat(e.nameTest,"\\s*)?")+operationBlockChar+e.nameTest+operationBlockChar,e.operationTestReg=new RegExp("^\\s*".concat(e.operationTest,"\\s*$")),e.matchedTest=operationBlockChar+e.nameTest+operationBlockChar,e.matchedTestReg=new RegExp(e.matchedTest,"g"),e.argTest="".concat(e.nameTest,"(?:\\s*").concat(operationBlockChar+e.nameTest+operationBlockChar,")?|").concat(e.numTest,"|").concat(e.operationTest),e.argTestReg=new RegExp("^\\s*(".concat(e.argTest,")\\s*$")),e.opTestReg=new RegExp("^\\s*(".concat(e.allRegex.suffixOperators,")?\\s*(").concat(e.allRegex.operators,")\\s*(").concat(e.allRegex.prefixOperators,")?\\s*(").concat(e.argTest,")\\s*")),e.opIntialTestReg=new RegExp("^\\s*(".concat(e.allRegex.prefixOperators,")?\\s*(").concat(e.argTest,")")),e.opFinalTestReg=new RegExp("^\\s*(".concat(e.allRegex.suffixOperators,")\\s*$")),e.getMatchedString=function(t,n){return t.replace(e.matchedTestReg,(function(e){return n.get(e).match}))},e}},{key:"parse",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.options,o=r.forbiddenChars;n=n instanceof Map?n:new Map,this.__clonedStr=e,this.__realPos=0;for(var a=0;a<o.length;a++)w(e,o[a])&&D("forbidden char "+o[a]);if(e=e.replace(/^\s*$/,(function(){t=new T("")})),t)return t;e=this.__parseBlocks(e,n);for(var u=0;u<r.rulesRegex.length;u++)e=e.replace(r.rulesRegex[u],(function(){}));e=this.__parseOpertors(e,n),this.__parse(e,r,n,{parseBlocks:!1,parseOperators:!1})}},{key:"__parse",value:function(e,t,n){var r,o=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if((a=Object.assign({parseBlocks:!0,parseOperators:!0},a)).parseBLocks&&(e=this.__parseBlocks(e,n)),a.parseOperators&&(e=this.__parseBlocks(e,n)),e=e.replace(/^\s*$/,(function(){r=new T("")})),r)return r;if(e=e.replace(new RegExp("^\\s*(##".concat(t.nameTest,"##)\\s*$")),(function(e,t){r=n.get(t).sNode})),r)return r;if(e=e.replace(new RegExp("^\\s*(".concat(t.nameTest,"\\s*\\.\\s*)+(?:(").concat(t.nameTest,")\\s*(##").concat(t.nameTest,"##))\\s*$")),(function(e,a,u,i){var s=n.get(i);if(t.all.prefixOperators.search(new RegExp(" \\(@(".concat(name,"),#(\\d*)\\) ")))>-1){var c=n.get(s),f=new T("prefixOperator",c,{name:name});n.set(name,f)}else if(s.sNode.calls("()")){var l,p=o.parse(a,n);l=new T("implementFunction",s.sNode.args,{name:u}),r=new T(".",[p,l],{dotType:"function",fullName:a+u})}})),r)return r;if(e=e.replace(/^\s*(.*)\.(\$\$[_a-zA-z]+\d*\$\$)\s*$/,(function(e,t,a){e&&(r=new T(".",[o.parse(first,n),new T("id",[],{name:a})],{dotType:"id",extension:e}))})),r)return r;if(e=e.replace(/^\s*(([_a-zA-z]+)\d*)\s*$/,(function(e,t,n){e&&(r=new T(n?"id":"num",[],{value:t}))})),r)return r;if(e=e.replace(/^(-?\d+\.?\d*)|(-?\d*\.?\d+)$/,(function(e,t,n){e&&(r=new T(n?"id":"num",[],{value:t}))})),r)return r;throw new Error("invalid script.\n"+e)}},{key:"__parseBlocks",value:function(e,t,n){for(var r,o=this,a=t.blocks,u=function(e,a){var u=x(),i=r.parser?r.parser.parse(a):o.__parse(a,t,n),s=new T("block",i,{id:r.id,tokenRef:r});return n.set(u,s),u},i=0;i<a.length;i++)r=a[i],e=e.replace(r.regex,u);return e}},{key:"__parseOperators",value:function(e,t,n){var r,o=oe(t.separators);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(new RegExp(a.regex).test(e)){var u,i=this.__get,s=[],c=oe(e.split(a));try{for(c.s();!(u=c.n()).done;){var f=u.value;s.push(this.parse(f,n))}}catch(e){c.e(e)}finally{c.f()}n.set(i,new T("separator",s,{name:a,length:s.length}))}}}catch(e){o.e(e)}finally{o.f()}var l,p="".concat(t.nameTest,"|").concat(t.numTest,"|##").concat(t.nameTest,"##"),h=new RegExp("^\\s*(".concat(t.allRegex.suffixOperators,")?\\s*(").concat(t.allRegex.operators,")\\s*(").concat(t.allRegex.prefixOperators,")?\\s*(").concat(p,")\\s*")),d=new RegExp("^\\s*(".concat(t.allRegex.prefixOperators,")?\\s*(").concat(p,")")),g=new RegExp("^\\s*(".concat(t.allRegex.suffixOperators,")\\s*$")),y="",m={name:null,sn:null};for(e=e.replace(d,(function(e,r,o){if(r){var a=o,u="prefixOperator",i=r;if(isNaN(a)){var s=!1;if(a.replace("##".concat(t.nameTest,"##"),(function(){s=!0})),s){var c=new T(u,n.get(a),{name:i});n.set(a,c),m.sn={name:a,sn:c}}else{var f=x(),l=new T(u,new T("variable",[],{name:a}),{name:i});n.set(f,l),m={name:f,sn:l}}}else{var p=x(),h=new T(u,new T("number",[],{value:parseInt(a)}),{name:i});n.set(p,h),m={name:p,sn:h}}}else{var d=!1;o.replace("##".concat(t.nameTest,"##"),(function(){d=!0})),m=d?{name:o,sn:n.get(o)}:{name:o}}return""}));l!==e;)l=e,e=e.replace(h,(function(r,o,a,u,i){if(a||D("operators","invalid operators",e,null),o)for(var s=0;s<t.suffixOperators.length;s++)if(t.suffixOperators[s].regex.test(o)){var c=m.name,f="suffixOperator",l=o;if(isNaN(c)){var p=!1;if(c.replace("##".concat(t.nameTest,"##"),(function(){p=!0})),p){var h=new T(f,m.sn,{name:l});n.set(c,h),m.sn=h}else{var d=x(),g=new T(f,new T("variable",[],{name:c}),{name:l});n.set(d,g),m={name:d,sn:g}}}else{var v=x(),b=new T(f,new T("number",[],{value:parseInt(c)}),{name:l});n.set(v,b),m={name:v,sn:b}}}if(y+=m.name+" "+a+" ",u){var w=i,E="prefixOperator",F=u;if(isNaN(w)){var R=!1;if(w.replace("##".concat(t.nameTest,"##"),(function(){R=!0})),R){var O=new T(E,n.get(w),{name:F});n.set(w,O),m.sn={name:w,sn:O}}else{var S=x(),_=new T(E,new T("variable",[],{name:w}),{name:F});n.set(S,_),m={name:S,sn:_}}}else{var A=x(),C=new T(E,new T("number",[],{value:parseInt(w)}),{name:F});n.set(A,C),m={name:A,sn:C}}}else{var k=!1;i.replace("##".concat(t.nameTest,"##"),(function(){k=!0})),m=k?{name:i,sn:n.get(i)}:{name:i}}return""}));return""!==e&&""!==(e=e.replace(g,(function(e,r){var o=m.name,a="suffixOperator",u=r;if(isNaN(o)){var i=!1;if(o.replace("##".concat(t.nameTest,"##"),(function(){i=!0})),i){var s=new T(a,m.sn,{name:u});n.set(o,s),m.sn={name:o,sn:s}}else{var c=x(),f=new T(a,new T("variable",[],{name:o}),{name:u});n.set(c,f),m={name:c,sn:f}}}else{var l=x(),p=new T(a,new T("number",[],{value:parseInt(o)}),{name:u});n.set(l,p),m={name:l,sn:p}}return y+=m.name,""})))&&D("operators","invalid suffix operator at the end","",null),y}}])&&ce(t.prototype,n),r&&ce(t,r),e}();function le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var he=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(le(this,e),t=Object.assign({parser:"inherit"},t),Object.assign(this,t),!this.opening||!this.closing)throw new Error("you must set the opening and the closing of the block");this.opened=!1,this.num=0}var t,n,r;return t=e,(n=[{key:"id",get:function(){return this._id},set:function(e){e instanceof RegExp?(this._id=e,this.regex=e,this.regexStr=e.source):e instanceof Object?(this._id=e,this.opening=this.id.opening,this.closing=this.id.closing,e.opening&&e.closing&&(e.content=e.content||"all",e.content instanceof RegExp?e.content=e.content.source:"all"===e.content?e.content="(?:.*?|\\s*)*?":e.content=v(e.content),this.regexStr="".concat(v(e.opening),"(").concat(e.content,")").concat(v(e.closing)),this.regex=new RegExp(this.regexStr))):(this._id=e,this.regex=new RegExp(v(e)),this.regexStr=this.regex.source),this.regex.global||(this.regex=new RegExp(this.regex.source,(this.regex.flags||"")+"g"))}},{key:"name",get:function(){return this._name?this._name:this.opening+this.closing},set:function(e){this._name=e}},{key:"content",get:function(){return this._contentTest||"all"},set:function(e){this._contentTest=e}}])&&pe(t.prototype,n),r&&pe(t,r),e}();function de(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=ye(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){i=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(i)throw a}}}}function ge(e){return function(e){if(Array.isArray(e))return me(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ye(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){if(e){if("string"==typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?me(e,t):void 0}}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function be(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return De(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return De(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){i=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(i)throw a}}}}function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xe={Math:function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._options={autoMultSign:!0,vars:[],nameTest:"[a-zA-Z_]+\\d*",numTest:"\\d+\\.?\\d*|\\d*\\.?\\d+",prefixOperators:[new ne({id:"+"}),new ne({id:"-"})],suffixOperators:[new te({id:"!"}),new te({id:"deg"}),new te({id:"rad"})],operators:[new ee({id:".",zIndex:11}),new ee({id:"^",zIndex:10}),new ee({id:"**",zIndex:10}),new ee({id:"*",zIndex:9}),new ee({id:"/",zIndex:9}),new ee({id:"mod",zIndex:9}),new ee({id:"+",zIndex:7}),new ee({id:"-",zIndex:7}),new ee({id:">>",zIndex:6}),new ee({id:"<<",zIndex:6}),new ee({id:">=",zIndex:5}),new ee({id:"<=",zIndex:5}),new ee({id:"!=",zIndex:5}),new ee({id:"<",zIndex:5}),new ee({id:">",zIndex:5}),new ee({id:"==",zIndex:5}),new ee({id:"&",zIndex:4}),new ee({id:"band",zIndex:4}),new ee({id:"|",zIndex:4}),new ee({id:"bor",zIndex:4}),new ee({id:"bxor",zIndex:4}),new ee({id:"constrain",zIndex:4}),new ee({id:"in",zIndex:3}),new ee({id:"out",zIndex:3}),new ee({id:"xnor",zIndex:1}),new ee({id:"xor",zIndex:1}),new ee({id:"nand",zIndex:1}),new ee({id:"nor",zIndex:1}),new ee({id:"or",zIndex:1}),new ee({id:"and",zIndex:1}),new ee({id:"||",zIndex:1}),new ee({id:"&&",zIndex:1}),new ee({id:"=",zIndex:0})],separators:[new re({id:";"}),new re({id:","})],blocks:[new he({id:/\(([^(]*?)\)/,opening:"(",closing:")"}),new he({id:/\{([^{]*?)\}/,opening:"{",closing:"}"}),new he({id:/\[([^[]*?)\]/,opening:"[",closing:"]"}),new he({id:/"(.*?|\\")*"/,opening:'"',closing:'"'}),new he({id:/'(.*?|\\')*'/,opening:"'",closing:"'"})],forbiddenChars:[]},this.options=Object.assign(this._options,t||{})}var t,n,r;return t=e,(n=[{key:"prepareOptions",value:function(e){(e=Object.assign({nameTest:"[_a-zA-Z]+\\d*",numTest:"\\d*\\.?\\d+|\\d+\\.?\\d*",operators:[],suffixOperators:[],prefixOperators:[],separators:[],blocks:[],rules:[],forbiddenChars:[]},e)).forbiddenChars=[].concat(ge(e.forbiddenChars),ge(E));var t={operators:"",prefixOperators:"",suffixOperators:""},n=function(e){if(e&&e.length>0){for(var t=" ",n=function(n){var r=e[n],o=!1;t.replace(new RegExp("\\(@(".concat(r.regexStr,")#(\\d*)\\)")),(function(t,a,u){return Object.assign(e[n],e[parseInt(u)]),e.splice(parseInt(u),1),o=!0," (@".concat(r.toString(),",#").concat(n,") ")})),o||(t+="(@".concat(r.regexStr,"#").concat(n,")"))},r=0;r<e.length;r++)n(r);return t}};return t.operators=n(e.operators),t.prefixOperators=n(e.prefixOperators),t.suffixOperators=n(e.suffixOperators),e.all=t,(t={operators:"",prefixOperators:"",suffixOperators:""}).operators=(n=function(e){if(0==e.length)return"";if(e&&e.length>0){for(var t="",n=0;n<e.length;n++){var r=e[n];t+="".concat(r.regexStr,"|")}return t.slice(0,-1)}})(e.operators),t.prefixOperators=n(e.prefixOperators),t.suffixOperators=n(e.suffixOperators),e.allRegex=t,e.operators&&(e.operators=e.operators.sort((function(e,t){return-(e.zIndex-t.zIndex)}))),e.blocks={values:e.blocks,openedBlock:null},e.rulesRegex=[],e.rules.forEach((function(t){e.rulesRegex.push(new RegExp(t.getRegex()))})),e.nameTestReg=new RegExp(e.nameTest),e.numTestReg=new RegExp(e.numTest),e.matchedTest="¶\\w+¶",e.matchedTestReg=new RegExp(e.matchedTest,"g"),e.operationTestGrouped="(?:(".concat(e.nameTest,")\\s*)?(")+e.matchedTest+")",e.operationTestGroupedReg=new RegExp("^\\s*".concat(e.operationTestGrouped,"\\s*$")),e.operationTest="(?:".concat(e.nameTest,"\\s*)?")+e.matchedTest,e.operationTestReg=new RegExp("^\\s*".concat(e.operationTest,"\\s*$")),e.argTest="".concat(e.nameTest,"(?:\\s*").concat(e.matchedTest,")?|").concat(e.numTest,"|").concat(e.operationTest),e.argTestReg=new RegExp("^\\s*(".concat(e.argTest,")\\s*$")),e.opTestReg=new RegExp("^\\s*(".concat(e.allRegex.suffixOperators,")?\\s*(").concat(e.allRegex.operators,")\\s*(").concat(e.allRegex.prefixOperators,")?\\s*(").concat(e.argTest,")\\s*")),e.opIntialTestReg=new RegExp("^\\s*(".concat(e.allRegex.prefixOperators,")?\\s*(").concat(e.argTest,")")),e.opFinalTestReg=new RegExp("^\\s*(".concat(e.allRegex.suffixOperators,")\\s*$")),e.getMatchedString=function(t,n){return t.replace(e.matchedTestReg,(function(e){return n.get(e).match}))},e}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.options;t=t instanceof Map?t:new Map;for(var r=0;r<n.forbiddenChars.length;r++)w(e,n.forbiddenChars[r])&&D("forbiddenSymbol","forbidden symbol.");return this.__parse(e,n,t)}},{key:"__parse",value:function(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(o=Object.assign({parseBlocks:!0,parseOperators:!0},o),e=e.replace(/^\s*$/,(function(){r=new T("",[],{match:e})})),r)return r;o.parseBlocks&&(e=this.__parseBlocks(e,t,n)),o.parseOperators&&(e=this.__parseOperators(e,t,n));var a=this.__parseArg(e,t,n);return a.match=a.match||t.getMatchedString(e,n),a}},{key:"__parseBlocks",value:function(e,t,n){for(var r,o,a=this,u=t.blocks,i=function(e,u){var i=x(),s=[];r.parser&&(s="inherit"===r.parser?[a.__parse(u,t,n)]:[r.parser(u)]);var c=new T("block",s,{name:r.name,match:t.getMatchedString(e,n),content:t.getMatchedString(u,n)});return n.set(i,c),o=!1,i},s=0;s<u.values.length;s++)for(r=u.values[s],o=!1;!o;)o=!0,e=e.replace(r.regex,i);return e}},{key:"__parseOperators",value:function(e,t,n){var r,o=this,a=de(t.separators);try{for(a.s();!(r=a.n()).done;){var u=r.value;if(w(e,u.id)){var i,s=x(),c=[],f=de(e.split(u));try{for(f.s();!(i=f.n()).done;){var l=i.value;c.push(this.__parse(l,t,n))}}catch(e){f.e(e)}finally{f.f()}return n.set(s,new T("separator",c,{name:u.name,length:c.length,match:t.getMatchedString(e,n)})),s}}}catch(e){a.e(e)}finally{a.f()}var p="",h=null;e=e.replace(t.opIntialTestReg,(function(e,r,a){if(r){var u=x(),i=new T("prefixOperator",o.__parseArg(a,t,n),{name:r,match:t.getMatchedString(e,n)});n.set(u,i),h=u}else h=a;return""}));for(var d=!1;!d;)d=!0,e=e.replace(t.opTestReg,(function(r,a,u,i,s){if(u||D("operators","invalid operators",e,null),a){var c=x(),f=new T("suffixOperator",o.__parseArg(h,t,n),{name:a,match:t.getMatchedString(h+a,n)});n.set(c,f),h=c}if(p+="".concat(h," ").concat(u," "),i){var l=x(),g=new T("prefixOperator",o.__parseArg(s,t,n),{name:i,match:t.getMatchedString(i+s,n)});n.set(l,g),h=l}else h=s;return d=!1,""}));if(""!==e?""!==(e=e.replace(t.opFinalTestReg,(function(e,r){var a=x(),u=new T("suffixOperator",o.__parseArg(h,t,n),{name:r,match:t.getMatchedString(h+e,n)});return n.set(a,u),p+=a,""})))&&D("operators","invalid suffix operator at the end","",null):p+=h,!(d=t.argTestReg.test(p)))for(var g=0;g<t.operators.length;g++)for(d=!1;!d;)d=!0,w(p,t.operators[g].id)&&(p=p.replace(new RegExp("(".concat(t.argTest,") (").concat(t.operators[g].regexStr,") (").concat(t.argTest,")")),(function(e,r,a,u){var i=o.__parseArg(r,t,n),s=o.__parseArg(u,t,n),c=x();return n.set(c,new T("operator",[i,s],{name:a,match:t.getMatchedString(e,n)})),d=!1,c})));return p}},{key:"__parseArg",value:function(e,t,n){var r;if(e=e.replace(/^\s*(.*)\s*$/,"$1"),isNaN(e)||(r=new T("number",[],{value:parseFloat(e),match:e})),r)return r;if(e=e.replace(t.operationTestGroupedReg,(function(e,o,a){if(r=n.get(a),o&&"block"===r.type&&"()"===r.name)t.vars.find((function(e){return e===o})),r=new T("functionCalling",r.args,{name:o,match:t.getMatchedString(e,n)});else if(o)throw new Error("you have inputted a name (identifier) then an invalid block after it.")})),r)return r;if(e=e.replace(t.nameTestReg,(function(t){r=new T("variable",[],{name:t,match:e})})),r)return r;throw new Error("invalid script.\n"+e)}},{key:"options",get:function(){return this._options},set:function(e){this._options=this.prepareOptions(e)}}])&&ve(t.prototype,n),r&&ve(t,r),e}(),ProgMath:function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._options={autoMultSign:!0,vars:[],nameTest:"[a-zA-Z_]+\\d*",numTest:"\\d+\\.?\\d*|\\d*\\.?\\d+",prefixOperators:[new ne({id:"+"}),new ne({id:"-"})],suffixOperators:[new te({id:"!"}),new te({id:"deg"}),new te({id:"rad"})],operators:[new ee({id:"^",zIndex:10}),new ee({id:"*",zIndex:9}),new ee({id:"/",zIndex:9}),new ee({id:"mod",zIndex:9}),new ee({id:"+",zIndex:7}),new ee({id:"-",zIndex:7}),new ee({id:">>",zIndex:6}),new ee({id:"<<",zIndex:6}),new ee({id:">=",zIndex:5}),new ee({id:"<=",zIndex:5}),new ee({id:"!=",zIndex:5}),new ee({id:"<",zIndex:5}),new ee({id:">",zIndex:5}),new ee({id:"==",zIndex:5}),new ee({id:"&",zIndex:4}),new ee({id:"band",zIndex:4}),new ee({id:"|",zIndex:4}),new ee({id:"bor",zIndex:4}),new ee({id:"bxor",zIndex:4}),new ee({id:"constrain",zIndex:4}),new ee({id:"in",zIndex:3}),new ee({id:"out",zIndex:3}),new ee({id:"xnor",zIndex:1}),new ee({id:"xor",zIndex:1}),new ee({id:"nand",zIndex:1}),new ee({id:"nor",zIndex:1}),new ee({id:"or",zIndex:1}),new ee({id:"and",zIndex:1}),new ee({id:"||",zIndex:1}),new ee({id:"&&",zIndex:1}),new ee({id:"=",zIndex:0})],separators:[new re({id:";"}),new re({id:","})],blocks:[new he({id:{opening:"{",closing:"}"}}),new he({id:{opening:"[",closing:"]"}}),new he({id:{opening:"(",closing:")"}}),new he({id:{opening:'"',closing:'"'}}),new he({id:{opening:"'",closing:"'"}})],forbiddenChars:[]},this.options=t}var t,n,r;return t=e,(n=[{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.options;t=t instanceof Map?t:new Map;for(var r=0;r<n.forbiddenChars.length;r++)w(e,n.forbiddenChars[r])&&D("forbiddenSymbol","forbidden symbol.");return e=e.replace(/\s+/g,(function(){return" "})),this.__parse(e,n,t)}},{key:"__parse",value:function(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(o=Object.assign({parseBlocks:!0,parseOperators:!0},o),e=e.replace(/^\s*$/,(function(){r=new T("")})),r)return r;if(o.parseBlocks&&(e=this.__parseBlocks(e,t,n)),o.parseOperators&&(e=this.__parseOperators(e,t,n)),e=e.replace(/^\s*(.*)\s*$/,"$1"),isNaN(e)||(r=new T("number",[],{value:parseFloat(e)})),e=e.replace(t.operationTestReg,(function(e){r=n.get(e)})),r)return r;if(e=e.replace(t.nameTestReg,(function(e){r=new T("variable",[],{name:e})})),r)return r;throw new Error("invalid script.\n"+e)}},{key:"__parseBlocks",value:function(e,t,n){for(var r,o=this,a=t.blocks,u=function(e,a){var u=x(),i=new T("block",[o.__parse(a,t,n)],{id:r.id});return n.set(u,i),u},i=0;i<a.values.length;i++)r=a.values[i],e=e.replace(r.regex,u);return e}},{key:"__parseOperators",value:function(e,t,n){var r,o=be(t.separators);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(w(e,a.id)){var u,i=this.__get,s=[],c=be(e.split(a));try{for(c.s();!(u=c.n()).done;){var f=u.value;s.push(this.__parse(f,t,n))}}catch(e){c.e(e)}finally{c.f()}n.set(i,new T("separator",s,{name:a.id,length:s.length}))}}}catch(e){o.e(e)}finally{o.f()}var l="",p={name:null,sn:null};e=e.replace(t.opIntialTestReg,(function(e,r,o){if(r){var a=o,u="prefixOperator",i=r;if(isNaN(a)){var s=!1;if(a.replace(t.operationTestReg,(function(){s=!0})),s){var c=new T(u,n.get(a),{name:i});n.set(a,c),p.sn={name:a,sn:c}}else{var f=x(),l=new T(u,new T("variable",[],{name:a}),{name:i});n.set(f,l),p={name:f,sn:l}}}else{var h=x(),d=new T(u,new T("number",[],{value:parseInt(a)}),{name:i});n.set(h,d),p={name:h,sn:d}}}else{var g=!1;o.replace(t.operationTestReg,(function(){g=!0})),p=g?{name:o,sn:n.get(o)}:{name:o}}return""}));for(var h=!1;!h;)h=!0,e=e.replace(t.opTestReg,(function(r,o,a,u,i){if(a||D("operators","invalid operators",e,null),o){var s=p,c="suffixOperator",f=o;if(isNaN(s)){var d=!1;if(s.replace(t.operationTestReg,(function(){d=!0})),d){var g=new T(c,p.sn,{name:f});n.set(s,g),p.sn=g}else{var y=x(),m=new T(c,new T("variable",[],{name:s}),{name:f});n.set(y,m),p={name:y,sn:m}}}else{var v=x(),b=new T(c,new T("number",[],{value:parseInt(s)}),{name:f});n.set(v,b),p={name:v,sn:b}}}if(l+="".concat(p.name," ").concat(a," "),u){var w=i,E="prefixOperator",F=u;if(isNaN(w)){var R=!1;if(w.replace(t.operationTestReg,(function(){R=!0})),R){var O=new T(E,n.get(w),{name:F});n.set(w,O),p.sn={name:w,sn:O}}else{var S=x(),_=new T(E,new T("variable",[],{name:w}),{name:F});n.set(S,_),p={name:S,sn:_}}}else{var A=x(),C=new T(E,new T("number",[],{value:parseInt(w)}),{name:F});n.set(A,C),p={name:A,sn:C}}}else{var k=!1;i.replace(t.operationTestReg,(function(){k=!0})),p=k?{name:i,sn:n.get(i)}:{name:i}}return h=!1,""}));""!==e?""!==(e=e.replace(t.opFinalTestReg,(function(e,r){var o=p.name,a="suffixOperator",u=r;if(isNaN(o)){var i=!1;if(o.replace(t.operationTestReg,(function(){i=!0})),i){var s=new T(a,p.sn,{name:u});n.set(o,s),p.sn={name:o,sn:s}}else{var c=x(),f=new T(a,new T("variable",[],{name:o}),{name:u});n.set(c,f),p={name:c,sn:f}}}else{var h=x(),d=new T(a,new T("number",[],{value:parseInt(o)}),{name:u});n.set(h,d),p={name:h,sn:d}}return l+=p.name,""})))&&D("operators","invalid suffix operator at the end","",null):l+=p.name;for(var d=0;d<t.operators.length;d++)for(h=!1;!h;)h=!0,w(l,t.operators[d].id)&&(l=l.replace(new RegExp("(".concat(t.argTest,")\\s*(").concat(t.operators[d].regexStr,")\\s*(").concat(t.argTest,")")),(function(e,r,o,a){var u,i;if(isNaN(r)){var s=!1;r.replace(t.operationTestReg,(function(){u=n.get(r),s=!0})),s||(u=new T("variable",[],{name:r}))}else u=new T("number",[],{value:parseInt(r)});if(isNaN(a)){var c=!1;a.replace(t.operationTestReg,(function(){i=n.get(a),c=!0})),c||(i=new T("variable",[],{name:a}))}else i=new T("number",[],{value:parseInt(a)});var f=x();return n.set(f,new T("operator",[u,i],{name:o})),h=!1,f})));return l}},{key:"options",get:function(){return this._options},set:function(e){e=Object.assign(this._options,e),prepareOptions(e)}}])&&we(t.prototype,n),r&&we(t,r),e}()},Ee={Operator:ee,SuffixOperator:te,PrefixOperator:ne,Separator:re,Block:he};function Fe(e){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){i=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(i)throw a}}}}function Oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _e(e,t){return(_e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Te(e);if(t){var o=Te(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ce(this,n)}}function Ce(e,t){return!t||"object"!==Fe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_e(e,t)}(a,e);var t,n,r,o=Ae(a);function a(e,t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),0==e.length)throw new Error("Sequence musn\t be void.");return o.call(this,"AnyOf",-1,e,t)}return t=a,(n=[{key:"getRegex",value:function(e){e=e||{num:0,increase:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.num+=e,this}},this.index=e.num;var t="";return this.childrenRules.forEach((function(n){t+=n.getRegex(e.increase())+"|"})),"(".concat(t,")")}},{key:"parse",value:function(e,t){var n=this,r=t||e[this.index+1],o=[];this.blockState&&(r=r.replace(this.rootParser.matchesTest,(function(e,t,r){return n.rootParser.matches[t][r].str})));var a,u=Re(this.childrenRules);try{for(u.s();!(a=u.n()).done;){var i=a.value;if(e.values[i.index]){o.push(i.parse(e));break}}}catch(e){u.e(e)}finally{u.f()}return new T(this.name,o,{match:r})}}])&&Se(t.prototype,n),r&&Se(t,r),a}(_);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ne(e);if(t){var o=Ne(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pe(this,n)}}function Pe(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ne(e){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(a,e);var t,n,r,o=ze(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,"Anything",0,[],e)}return t=a,(n=[{key:"getRegex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e=e||{num:0,increase:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.num+=e,this}},this.index=e.num,"(.*?)"}},{key:"parse",value:function(e,t){var n=this,r=t||e[this.index+1],o=[];return this.blockState&&(r=r.replace(this.rootParser.matchesTest,(function(e,t,r){return n.rootParser.matches[t][r].str}))),this.parser&&o.push(this.parser.parse(r)),new T(this.name,o,{match:r})}}])&&je(t.prototype,n),r&&je(t,r),a}(_);function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ge(e,t){return(Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze(e);if(t){var o=Ze(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qe(this,n)}}function qe(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ze(e){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ge(e,t)}(a,e);var t,n,r,o=Ke(a);function a(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),t=Object.assign({spaced:!0},t),o.call(this,"Repeat",1,[e],t)}return t=a,(n=[{key:"getRegex",value:function(e){e=e||{num:0,increase:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.num+=e,this}},this.index=e.num;var t,n=isNaN(this.length)?"+":"{".concat(this.length,"}"),r=this.childrenRules[0].getRegex(e.increase());return this.repeatedRegex=new RegExp(r,"g"),t=this.spaced?"(?:".concat(r,"\\s*)").concat(n):"".concat(r).concat(n),this.regex=t,"(".concat(t,")")}},{key:"parse",value:function(e,t){var n=this,r=t||e[this.index+1],o=[];return r.replace(this.repeatedRegex,(function(t){return o.push(n.childrenRules[0].parse(e,t)),""})),this.blockState&&(r=r.replace(this.rootParser.matchesTest,(function(e,t,r){return n.rootParser.matches[t][r].str}))),new T(this.name,o,{match:r})}}])&&Ue(t.prototype,n),r&&Ue(t,r),a}(_);function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ye(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){i=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(i)throw a}}}}function Qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=et(e);if(t){var o=et(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xe(this,n)}}function Xe(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function et(e){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(a,e);var t,n,r,o=Je(a);function a(e,t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),t=Object.assign({spaced:!0},t),0==e.length)throw new Error("Sequence musn\t be void.");return o.call(this,"Sequence",-1,e,t)}return t=a,(n=[{key:"getRegex",value:function(e){var t=this;e=e||{num:0,increase:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.num+=e,this}},this.index=e.num;var n="";return this.childrenRules.forEach((function(r){n+=r.getRegex(e.increase()),t.spaced&&(n+="\\s*")})),this.spaced&&(n=n.slice(0,-"\\s*".length)),this.regex=n,"(".concat(n,")")}},{key:"parse",value:function(e,t){var n,r=this,o=t||e[this.index+1],a=[],u=Ye(this.childrenRules);try{for(u.s();!(n=u.n()).done;){var i=n.value;a.push(i.parse(e))}}catch(e){u.e(e)}finally{u.f()}return this.blockState&&(o=o.replace(this.rootParser.matchesTest,(function(e,t,n){return r.rootParser.matches[t][n].str}))),new T(this.name,a,{match:o})}}])&&We(t.prototype,n),r&&We(t,r),a}(_),nt={Node:T,Parser:q,OperatorsParser:fe,CustomParsers:xe,TOKENS:{STRING:'"(?:[^"]|\\")*"',NUMBER:"\\d+.\\d*|\\d*.\\d+",BRACKETS:"\\{.*?\\}",ROUND_BRACKETS:"\\(.*?\\)",CURLEY_BRACKETS:"\\{.*?\\}",SQUARE_BRACKETS:"\\[.*?\\]"},Tokens:Ee,Rules:{AnyOf:ke,AnyThing:Me,Block:N,Repeat:Le,Sequence:tt,Rule:_}};t.default=nt}]);export default MagicalParser;export{MagicalParser};